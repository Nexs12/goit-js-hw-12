{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getPosts(searchQuery, page, perPage) {\n    const BASE_URL = \"https://pixabay.com/api/\";\n    const params = {\n        key: \"44102450-6df98fde061003ef9a12efa89\",\n        q: searchQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page,\n        per_page: perPage\n    };\n\n    try {\n        const response = await axios.get(BASE_URL, { params });\n        return response.data;\n    } catch (error) {\n        throw new Error(`HTTP error! status: ${error.response.status}`);\n    }\n};","export function postTemplate(post) {\n    return `\n        <a class=\"gallery-link\" href=\"${post.largeImageURL}\">\n            <img src=\"${post.webformatURL}\" alt=\"${post.tags}\" class=\"gallery-item-image\">\n            <ul class=\"info\">\n                <li class=\"info-title\">Likes<span class=\"info-value\">${post.likes}</span></li>\n                <li class=\"info-title\">Views<span class=\"info-value\">${post.views}</span></li>\n                <li class=\"info-title\">Comments<span class=\"info-value\">${post.comments}</span></li>\n                <li class=\"info-title\">Downloads<span class=\"info-value\">${post.downloads}</span></li>\n            </ul>\n        </a>\n    `;\n};\n\nexport function postsTemplate(arr) {\n    return arr.map(postTemplate).join(\"\");\n};","import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getPosts } from \"./js/pixabay-api\";\nimport { postsTemplate } from \"./js/render-functions\";\n\nconst form = document.querySelector(\".search-form\");\nconst postsGallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\n\nlet searchQuery = '';\nlet page = 1;\nconst perPage = 15;\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n            captions: true,\n            captionsData: 'alt',\n            captionDelay: 250 \n        });\nhideLoader();\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    searchQuery = event.target.elements.searchQuery.value.trim();\n    page = 1;\n\n    if (!searchQuery) {\n        iziToast.info({\n            position: 'topRight',\n            message: \"Please enter a search query\",\n        });\n        return;\n    };\n\n    postsGallery.innerHTML = \"\";\n    hideLoadMoreBtn();\n    showLoader();\n\n    try {\n        const data = await getPosts(searchQuery, page, perPage);\n\n        if (data.hits.length === 0) {\n            iziToast.error({\n                position: 'topRight',\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n            return;\n        }\n\n        const markup = postsTemplate(data.hits);\n        postsGallery.insertAdjacentHTML(\"beforeend\", markup);\n\n        lightbox.refresh();\n\n        if (page < totalPages) {\n            showLoadMoreBtn();\n        } else {\n            iziToast.info({\n                position: 'topRight',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n    } catch (error) {\n        iziToast.warning({\n            title: \"Error\",\n            message: `Something went wrong. ${error.message}`\n        })\n    } finally {\n        event.target.reset();\n        hideLoader();\n    }\n};\n\nasync function loadMore() {\n    page += 1;\n    showLoader();\n\n    try {\n        const data = await getPosts(searchQuery, page, perPage);\n\n        const markup = postsTemplate(data.hits);\n        postsGallery.insertAdjacentHTML(\"beforeend\", markup);\n        lightbox.refresh();\n\n        scrollToNewImages();\n\n        if (page >= totalPages) {\n            hideLoadMoreBtn();\n            iziToast.info({\n                position: 'topRight',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n        \n    } catch (error) {\n        iziToast.info({\n            position: 'topRight',\n            message: `We're sorry, but you've reached the end of search results. ${error.message}`\n        });\n        hideLoadMoreBtn();\n    } finally {\n        hideLoader();\n        \n    }\n}\n\nform.addEventListener(\"submit\", handleSubmit);\nloadMoreBtn.addEventListener(\"click\", loadMore);\n\nfunction showLoader() {\n    loader.style.display = \"block\";\n};\n\nfunction hideLoader() {\n    loader.style.display = \"none\";\n}\n\nfunction showLoadMoreBtn() {\n    loadMoreBtn.style.display = \"block\";\n}\n\nfunction hideLoadMoreBtn() {\n    loadMoreBtn.style.display = \"none\";\n}\n\nfunction scrollToNewImages() {\n    const gallery = document.querySelector('.gallery');\n    const galleryCard = gallery.querySelector('.gallery-link');\n    if (galleryCard) {\n        const cardHeight = galleryCard.getBoundingClientRect().height;\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth'\n        });\n    }\n}"],"names":["getPosts","searchQuery","page","perPage","BASE_URL","params","axios","error","postTemplate","post","postsTemplate","arr","form","postsGallery","loader","loadMoreBtn","lightbox","SimpleLightbox","hideLoader","handleSubmit","event","iziToast","hideLoadMoreBtn","showLoader","data","markup","showLoadMoreBtn","loadMore","scrollToNewImages","galleryCard","cardHeight"],"mappings":"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"}